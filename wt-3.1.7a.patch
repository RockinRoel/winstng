diff -rupdN wt-3.1.7a.orig/cmake/WtFindGm.txt wt-3.1.7a/cmake/WtFindGm.txt
--- wt-3.1.7a.orig/cmake/WtFindGm.txt	2011-01-18 19:32:06.189635000 +0100
+++ wt-3.1.7a/cmake/WtFindGm.txt	2011-01-18 19:32:17.341635000 +0100
@@ -11,6 +11,7 @@ FIND_PATH(GM_INCLUDE_DIR
     ${GM_PREFIX}/include/GraphicsMagick/
     ${GM_PREFIX}/include/
     ${GM_PREFIX}/
+    include/GraphicsMagick/
     /usr/include/GraphicsMagick/
     /usr/include/
     /usr/local/include/GraphicsMagick/
diff -rupdN wt-3.1.7a.orig/CMakeLists.txt wt-3.1.7a/CMakeLists.txt
--- wt-3.1.7a.orig/CMakeLists.txt	2011-01-18 19:32:06.189635000 +0100
+++ wt-3.1.7a/CMakeLists.txt	2011-01-18 19:32:17.341635000 +0100
@@ -71,6 +71,10 @@ IF(NOT SHARED_LIBS)
   ENDIF(WIN32)
 ENDIF(NOT SHARED_LIBS)
 
+IF(NOT EXAMPLES_DESTINATION)
+  SET(EXAMPLES_DESTINATION lib/Wt/examples)
+ENDIF(NOT EXAMPLES_DESTINATION)
+
 IF(WIN32)
   IF(SHARED_LIBS)
     # See http://svn.boost.org/trac/boost/ticket/3465
@@ -344,11 +348,7 @@ IF (DOXYGEN_FOUND)
 SUBDIRS(src)
 
 IF(BUILD_EXAMPLES)
-  IF(WIN32)
     SUBDIRS(examples)
-  ELSE(WIN32)
-    SUBDIRS(EXCLUDE_FROM_ALL examples)
-  ENDIF(WIN32)
 ENDIF(BUILD_EXAMPLES)
 
 IF(BUILD_TESTS)
diff -rupdN wt-3.1.7a.orig/examples/CMakeLists.txt wt-3.1.7a/examples/CMakeLists.txt
--- wt-3.1.7a.orig/examples/CMakeLists.txt	2011-01-18 19:32:06.329635000 +0100
+++ wt-3.1.7a/examples/CMakeLists.txt	2011-01-18 19:36:22.793635001 +0100
@@ -13,6 +13,7 @@ ADD_DEFINITIONS(-DWT_DEPRECATED_3_0_0)
 # The WT_ADD_EXAMPLE function builds a DLL in case of ISAPI, and an executable
 # in case of FCGI or HTTPD connectors. It also makes sure that the example
 # links to the proper libraries (connector + wt).
+
 MACRO(WT_ADD_EXAMPLE name)
   IF(EXAMPLES_CONNECTOR MATCHES "wtisapi")
     SET(MYLIST ${ARGV})
@@ -30,6 +31,39 @@ MACRO(WT_ADD_EXAMPLE name)
     SET_TARGET_PROPERTIES(${name} PROPERTIES COMPILE_FLAGS "/W3 /Wp64 /wd4251 /wd4275")
   ENDIF(MSVC)
   TARGET_LINK_LIBRARIES(${name} ${EXAMPLES_CONNECTOR})
+
+  # Find the subdirectory inside wt/examples where this example resides.
+  # Works even if there is no project(...), or there is more than one
+  # example in that subdirectory 
+  GET_TARGET_PROPERTY(${name}_SOURCEFILES ${name} SOURCES)
+  LIST(GET ${name}_SOURCEFILES 0 ${name}_FIRST_SOURCEFILE )
+  GET_SOURCE_FILE_PROPERTY(${name}_FIRST_SOURCEFILE_FULLPATH ${${name}_FIRST_SOURCEFILE} LOCATION)
+  STRING(REPLACE ${WT_SOURCE_DIR}/examples/ "" ${name}_SUBDIRANDSOURCE ${${name}_FIRST_SOURCEFILE_FULLPATH})
+  STRING(REPLACE /${${name}_FIRST_SOURCEFILE} "" ${name}_SUBDIR ${${name}_SUBDIRANDSOURCE})
+  STRING(REPLACE /${${name}_FIRST_SOURCEFILE} "" ${name}_TARGET_SOURCE_DIR ${${name}_FIRST_SOURCEFILE_FULLPATH} )
+  
+  SET( EXAMPLESUBDIR ${${name}_SUBDIR} )
+  SET( EXAMPLESUBDIRFROMPREFIX ${EXAMPLES_DESTINATION}/${EXAMPLESUBDIR} )
+  STRING( REPLACE .wt "" EXAMPLENAME ${name} )
+  
+  INSTALL( TARGETS ${name} DESTINATION ${EXAMPLES_DESTINATION}/${${name}_SUBDIR} )
+  INSTALL( DIRECTORY ${${name}_TARGET_SOURCE_DIR} DESTINATION ${EXAMPLES_DESTINATION} )
+
+  IF(WIN32)
+    CONFIGURE_FILE(${WT_SOURCE_DIR}/examples/run-example.bat.cmake ${WT_BINARY_DIR}/${EXAMPLENAME}.bat @ONLY)
+    INSTALL(PROGRAMS ${WT_BINARY_DIR}/${EXAMPLENAME}.bat DESTINATION bin )
+
+    IF(INSTALL_RESOURCES)
+      INSTALL(DIRECTORY ${WT_SOURCE_DIR}/resources DESTINATION ${EXAMPLES_DESTINATION}/${EXAMPLESUBDIR})  # Can't safely make symlinks of Windows
+    ENDIF(INSTALL_RESOURCES)
+  ELSE(WIN32)
+    CONFIGURE_FILE(${WT_SOURCE_DIR}/examples/run-example.cmake ${WT_BINARY_DIR}/${EXAMPLENAME} @ONLY)
+    INSTALL(PROGRAMS ${WT_BINARY_DIR}/${EXAMPLENAME} DESTINATION ${EXAMPLES_DESTINATION}/${EXAMPLESUBDIR})
+    IF(INSTALL_RESOURCES)
+      INSTALL( CODE "EXECUTE_PROCESS(COMMAND ${CMAKE_COMMAND} -E create_symlink ${CMAKE_INSTALL_PREFIX}/share/Wt/resources ${EXAMPLES_DESTINATION}/${EXAMPLESUBDIR}/resources)" )
+    ENDIF(INSTALL_RESOURCES)
+  ENDIF(WIN32)
+
 ENDMACRO(WT_ADD_EXAMPLE)
 
 SUBDIRS(
diff -rupdN wt-3.1.7a.orig/examples/run-example.bat.cmake wt-3.1.7a/examples/run-example.bat.cmake
--- wt-3.1.7a.orig/examples/run-example.bat.cmake	1970-01-01 01:00:00.000000000 +0100
+++ wt-3.1.7a/examples/run-example.bat.cmake	2011-01-18 19:32:17.341635000 +0100
@@ -0,0 +1,7 @@
+set PATH=%~p0;%PATH%
+set OLDPWD=%CD%
+REM Required until wthttp accepts a "--approot path" parameter
+cd ..\\lib\\Wt\\examples\\@EXAMPLESUBDIR@
+
+%~p0\\..\\lib\\Wt\\examples\\@EXAMPLESUBDIR@\\@EXAMPLENAME@.wt  --docroot ..\\lib\\Wt\\examples\\@EXAMPLESUBDIR@ --http-port 8080 --http-addr 0.0.0.0 %*
+cd %OLDPWD%
diff -rupdN wt-3.1.7a.orig/examples/run-example.cmake wt-3.1.7a/examples/run-example.cmake
--- wt-3.1.7a.orig/examples/run-example.cmake	1970-01-01 01:00:00.000000000 +0100
+++ wt-3.1.7a/examples/run-example.cmake	2011-01-18 19:32:17.341635000 +0100
@@ -0,0 +1,12 @@
+#!/bin/sh
+
+_DIRNAME=`dirname "$0"`
+EXAMPLEPREFIX=`readlink -e $_DIRNAME`
+EXAMPLESUBDIR=@EXAMPLESUBDIR@
+EXAMPLESUBDIRFROMPREFIX=@EXAMPLESUBDIRFROMPREFIX@
+PREFIX=`echo $EXAMPLEPREFIX | sed s,$EXAMPLESUBDIRFROMPREFIX,,g`
+
+# Required until wthttp accepts a "--approot path" parameter
+cd $EXAMPLEPREFIX
+
+PATH=$PREFIX/bin:$PATH LD_LIBRARY_PATH=$PREFIX/lib:$LD_LIBRARY_PATH DYLD_LIBRARY_PATH=$PREFIX/lib:$DYLD_LIBRARY_PATH $EXAMPLEPREFIX/@EXAMPLENAME@.wt --docroot $EXAMPLEPREFIX/ --http-port 8080 --http-addr 0.0.0.0 $@
